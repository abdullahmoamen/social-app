(this.webpackJsonpundefined=this.webpackJsonpundefined||[]).push([[5],{295:function(e,a,t){"use strict";t.r(a);var s=t(9),c=t(1),r=t(12),n=t(15),i=t(18),l=t(262),u=t.n(l),o=t(5),h=t(23),d=t(0);a.default=function(){var e=Object(c.useRef)(null),a=Object(c.useContext)(r.a),t=Object(c.useContext)(n.a),l=Object(c.useRef)(null),f=Object(c.useRef)(null),j=Object(i.a)({fieldValue:"",chatMessages:[]}),m=Object(s.a)(j,2),b=m[0],p=m[1];function O(t){t.preventDefault(),e.current.emit("chatFromBrowser",{message:b.fieldValue,token:a.user.token,chat:a.user.chat}),""!=b.fieldValue&&" "!=b.fieldValue&&"  "!=b.fieldValue&&p((function(e){e.chatMessages.push({message:e.fieldValue,username:a.user.username,avatar:a.user.avatar,chat:a.user.chat}),e.fieldValue=""}))}return Object(c.useEffect)((function(){a.isChatOpen&&(l.current.focus(),t({type:"clearUnreadChatCount"}))}),[a.isChatOpen]),Object(c.useEffect)((function(){f.current.scrollTop=f.current.scrollHeight,b.chatMessages.length&&!a.isChatOpen&&t({type:"incrementUnreadChatCount"})}),[b.chatMessages]),Object(c.useEffect)((function(){return e.current=u()(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).BACKENDURL||"https://backend-social-app1.herokuapp.com"),e.current.on("chatFromServer",(function(e){p((function(a){a.chatMessages.push(e)}))})),function(){return e.current.disconnect()}}),[]),Object(d.jsxs)("div",{id:"chat-wrapper",className:"chat-wrapper shadow border-top border-left border-right "+(a.isChatOpen?"chat-wrapper--is-visible":""),children:[Object(d.jsxs)("div",{className:"chat-title-bar bg-primary",children:["Chat",Object(d.jsx)("span",{className:"chat-title-bar-close",onClick:function(){return t({type:"closeChat"})},children:Object(d.jsx)("i",{className:"fas fa-times-circle"})})]}),Object(d.jsx)("div",{id:"chat",className:"chat-log",ref:f,children:b.chatMessages.map((function(e,t){return e.username==a.user.username?Object(d.jsxs)("div",{className:"chat-self",children:[Object(d.jsx)("div",{className:"chat-message",children:Object(d.jsx)("div",{className:"chat-message-inner",children:e.message})}),Object(d.jsx)("img",{className:"chat-avatar avatar-tiny",src:e.avatar})]},t):Object(d.jsxs)("div",{className:"chat-other",children:[Object(d.jsx)(o.b,{to:"/profile/".concat(e.username),children:Object(d.jsx)("img",{className:"avatar-tiny",src:e.avatar})}),Object(d.jsx)("div",{className:"chat-message",children:Object(d.jsxs)("div",{className:"chat-message-inner",children:[Object(d.jsx)(o.b,{to:"/profile/".concat(e.username),children:Object(d.jsxs)("strong",{children:[e.username,": "]})}),e.message]})})]},t)}))}),Object(d.jsxs)("form",{onSubmit:O,id:"chatForm",className:"chat-form border-top",children:[Object(d.jsx)("input",{required:!0,value:b.fieldValue,onChange:function(e){var a=e.target.value;p((function(e){e.fieldValue=a}))},ref:l,type:"text",className:"chat-field",id:"chatField",placeholder:"Type a message\u2026",autoComplete:"off",autoFocus:!0}),Object(d.jsxs)("button",{onClick:O,className:"chat-button btn-info","data-tip":"Send","data-for":"send",children:[Object(d.jsx)("i",{className:"far fa-paper-plane"})," "]}),Object(d.jsx)(h.a,{id:"send",className:"custom-tooltip"})]})]})}}}]);
//# sourceMappingURL=5.3dfe8890.chunk.js.map