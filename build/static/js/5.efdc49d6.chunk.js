(this.webpackJsonpundefined=this.webpackJsonpundefined||[]).push([[5],{295:function(e,a,t){"use strict";t.r(a);var s=t(9),c=t(1),r=t(12),n=t(15),i=t(18),u=t(262),l=t.n(u),o=t(5),h=t(0);a.default=function(){var e=Object(c.useRef)(null),a=Object(c.useContext)(r.a),t=Object(c.useContext)(n.a),u=Object(c.useRef)(null),d=Object(c.useRef)(null),f=Object(i.a)({fieldValue:"",chatMessages:[]}),j=Object(s.a)(f,2),m=j[0],b=j[1];return Object(c.useEffect)((function(){a.isChatOpen&&(u.current.focus(),t({type:"clearUnreadChatCount"}))}),[a.isChatOpen]),Object(c.useEffect)((function(){d.current.scrollTop=d.current.scrollHeight,m.chatMessages.length&&!a.isChatOpen&&t({type:"incrementUnreadChatCount"})}),[m.chatMessages]),Object(c.useEffect)((function(){return e.current=l()(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).BACKENDURL||"https://backend-social-app1.herokuapp.com"),e.current.on("chatFromServer",(function(e){b((function(a){a.chatMessages.push(e)}))})),function(){return e.current.disconnect()}}),[]),Object(h.jsxs)("div",{id:"chat-wrapper",className:"chat-wrapper shadow border-top border-left border-right "+(a.isChatOpen?"chat-wrapper--is-visible":""),children:[Object(h.jsxs)("div",{className:"chat-title-bar bg-primary",children:["Chat",Object(h.jsx)("span",{className:"chat-title-bar-close",onClick:function(){return t({type:"closeChat"})},children:Object(h.jsx)("i",{className:"fas fa-times-circle"})})]}),Object(h.jsx)("div",{id:"chat",className:"chat-log",ref:d,children:m.chatMessages.map((function(e,t){return e.username==a.user.username?Object(h.jsxs)("div",{className:"chat-self",children:[Object(h.jsx)("div",{className:"chat-message",children:Object(h.jsx)("div",{className:"chat-message-inner",children:e.message})}),Object(h.jsx)("img",{className:"chat-avatar avatar-tiny",src:e.avatar})]},t):Object(h.jsxs)("div",{className:"chat-other",children:[Object(h.jsx)(o.b,{to:"/profile/".concat(e.username),children:Object(h.jsx)("img",{className:"avatar-tiny",src:e.avatar})}),Object(h.jsx)("div",{className:"chat-message",children:Object(h.jsxs)("div",{className:"chat-message-inner",children:[Object(h.jsx)(o.b,{to:"/profile/".concat(e.username),children:Object(h.jsxs)("strong",{children:[e.username,": "]})}),e.message]})})]},t)}))}),Object(h.jsx)("form",{onSubmit:function(t){t.preventDefault(),e.current.emit("chatFromBrowser",{message:m.fieldValue,token:a.user.token,chat:a.user.chat}),b((function(e){e.chatMessages.push({message:e.fieldValue,username:a.user.username,avatar:a.user.avatar,chat:a.user.chat}),e.fieldValue=""}))},id:"chatForm",className:"chat-form border-top",children:Object(h.jsx)("input",{required:!0,value:m.fieldValue,onChange:function(e){var a=e.target.value;b((function(e){e.fieldValue=a}))},ref:u,type:"text",className:"chat-field",id:"chatField",placeholder:"Type a message\u2026",autoComplete:"off",autoFocus:!0})})]})}}}]);
//# sourceMappingURL=5.efdc49d6.chunk.js.map